#!/usr/bin/env bash

ROOT_DIR=$(cd $(dirname $(dirname $0)) && pwd)

if [ ! $(which gometalinter) ];then
  echo -e "\n Installing gometalinter..."
  go get -u github.com/alecthomas/gometalinter
  gometalinter --install --update
fi

gometalinter --disable-all \
    --enable=golint \
    --enable=goconst \
    --enable=vet \
    --enable=vetshadow \
    --enable=gofmt \
    --enable=gocyclo --cyclo-over=10 \
    --enable=deadcode \
    --deadline=15s \
    ./... \
  | awk -f $ROOT_DIR/bin/lint-files.awk \
  | awk -f $ROOT_DIR/bin/lint-linters.awk \
  | sort # https://www.pivotaltracker.com/story/show/105609756